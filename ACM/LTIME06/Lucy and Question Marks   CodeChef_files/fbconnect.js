Drupal.fbconnect=Drupal.fbconnect||{};Drupal.fbconnect.init=function(){Drupal.behaviors.fbconnect=function(a){if(a!=document){jQuery(a).each(function(){FB.XFBML.parse(this)})}Drupal.fbconnect.initLogoutLinks(a)};if(Drupal.settings.fbconnect.loginout_mode=="auto"){FB.Event.subscribe("auth.authResponseChange",Drupal.fbconnect.reload_ifUserConnected)}Drupal.behaviors.fbconnect(document)};Drupal.fbconnect.logout=function(b){var a=Drupal.settings.basePath+"logout";if(!b){FB.logout(function(c){window.location.href=a})}else{window.location.href=a}};Drupal.fbconnect.reload_ifUserConnected=function(b){var a=Drupal.settings.fbconnect.user;if(!b.authResponse||a.uid){return}if(b.authResponse.uid!=a.fbuid){window.location.reload()}};Drupal.fbconnect.initLogoutLinks=function(e){var d=Drupal.settings.fbconnect.loginout_mode;var b=Drupal.settings.fbconnect.user;var f=Drupal.settings.basePath;var c=f+"logout";var a=$("a[href="+c+"]",e).not(".logout_link_inited");if(d=="manual"){return}a.addClass("logout_link_inited").bind("click",function(){var g=FB.getAuthResponse()&&FB.getAuthResponse().uid;if(!b.fbuid||b.fbuid!=g){return}if(d=="auto"){Drupal.fbconnect.logout()}else{if(d=="ask"){var j={"!site_name":Drupal.settings.fbconnect.invite_name};var i=[{label:Drupal.t("Facebook and !site_name",j),click:function(){this.close();Drupal.fbconnect.logout()}},{name:"cancel",label:Drupal.t("!site_name Only",j),click:function(){this.close();Drupal.fbconnect.logout(true)}}];var h=new Drupal.fbconnect.PopupDialog({title:Drupal.t("Logout"),message:Drupal.t("Do you also want to logout from your Facebook account?"),buttons:i})}}return false})};Drupal.fbconnect.DoFastRegistration=function(a){FB.login(function(b){if(b.authResponse&&b.status=="connected"){FB.api("/me/permissions",function(c){if(c.data[0]["email"]){window.location.href=a.href}})}},{scope:"email"})};function facebook_onlogin_ready(){if(!FB.getAuthResponse()){return}$("#fbconnect-autoconnect-form").submit()}Drupal.fbconnect.PopupDialog=function(a){this.prepareDefaults(a);this.container=Drupal.theme("fb_popup_dialog",this.options);this.dialog=FB.Dialog.create({content:this.container,visible:false,loader:true,onClose:this.__close_handler,closeIcon:true});this.callback("load",this.dialog)};Drupal.fbconnect.PopupDialog.prototype.options={};Drupal.fbconnect.PopupDialog.prototype.createHandler=function(b,c){var a=this;return function(){a.callback(b,c)}};Drupal.fbconnect.PopupDialog.prototype.callback=function(b,c){c=c||{};switch(b){case"click":var a=c;if(a.click instanceof Function){a.click.apply(this,[a])}else{if(a.name=="cancel"){this.close()}}break;case"close":var a=this.findButton("cancel");if(a){this.callback("click",a)}break;case"load":this.show();break}};Drupal.fbconnect.PopupDialog.prototype.prepareDefaults=function(a){var b={title:"",message:" - ",buttons:{},showLoading:false,hideUntilLoaded:false};$.extend(this.options,b,a);this.__close_handler=this.createHandler("close",{});this.options.dialog=this;if(this.options.callback instanceof Function){this.callback=this.options.callback}};Drupal.fbconnect.PopupDialog.prototype.show=function(){if(this.dialog){FB.Dialog.show(this.dialog)}};Drupal.fbconnect.PopupDialog.prototype.close=function(){if(this.dialog){FB.Dialog.remove(this.dialog)}};Drupal.fbconnect.PopupDialog.prototype.findButton=function(a){var b=null;jQuery.each(this.options.buttons,function(d,c){if(c.name==a){b=c;return true}});return b};Drupal.theme.prototype.fb_popup_dialog_buttons=function(c,b){c=c||{};var a=$('<div class="dialog_buttons"></div>');jQuery.each(c,function(f,e){var d=$('<input type="button" class="dialog_inputbutton">');if(!e.name){e.name=f}if(e.attr){d.attr(e.attr)}if(e["class"]){d.addClass(e["class"])}if(e.name=="cancel"){d.addClass("dialog_inputaux")}d.addClass("fb_button_"+f);d.attr("value",e.label);d.click(b.createHandler("click",e));d.appendTo(a)});return a.get(0)};Drupal.theme.prototype.fb_popup_dialog=function(b){b=b||{buttons:{}};var a=document.createDocumentFragment();var c=['<h2 class="dialog_header"><span>',b.title.toString(),"</span></h2>",'<div class="dialog_stripes"></div>','<div class="dialog_content">',b.message.toString(),"</div>"];$(c.join("\n")).each(function(){a.appendChild(this)});if(b.buttons){a.appendChild(Drupal.theme("fb_popup_dialog_buttons",b.buttons,b.dialog))}return a};Drupal.theme.prototype.fbml_name=function(c,b){var a=['<fb:name uid="',c,'"'];var d={useyou:false,linked:false};b=$.extend({},d,b);a.push('" useyou="'+(!!b.useyou?"true":"false")+'"');a.push('" linked="'+(!!b.linked?"true":"false")+'"');a.push("></fb:name>");return a.join("")};Drupal.theme.prototype.fbml_profile_pic=function(c,b){var a=['<fb:profile-pic uid="',c,'"'];b=b||{};if(b.width){a.push('" width="'+b.width+'"')}if(b.height){a.push('" height="'+b.height+'"')}if(b.size){a.push('" size="'+b.size+'"')}a.push('" facebook-logo="'+(!!b["facebook-logo"]?"true":"false")+'"');a.push('" linked="'+(!!b.linked?"true":"false")+'"');a.push("></fb:profile-pic>");return a.join("")};jQuery(document).bind("fb:init",Drupal.fbconnect.init);function fb_invite_nonchallenge(a,b){$("#//For removal a").click(function(){window.open("/fbinvite/friends?d="+b+"&p="+a+"&c=0","facebook_window","scrollbars=1,width=800px,height=650px")});$("#FB_disp_message p").html("Ask your friends to help you solve this problem by using: ");return false}function fb_invite_challenge(a,b){$("#facebook-button a").click(function(){window.open("/fbinvite/friends?d="+b+"&p="+a+"&c=1","facebook_window","scrollbars=1,width=800px,height=650px")});$("#FB_disp_message p").html("Challenge your friends using: ");return false};